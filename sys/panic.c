#include "panic.h"

display_color_t _fail_image[] = 
{
    13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,
    13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,
    13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13, 0, 0,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13, 0,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,
    13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13, 0,15,12, 0,13,13, 0, 0,13,13, 0, 0,13,13,13,13,13,13,13,13,13,13,13, 0,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,
    13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13, 0,15,12,12,12, 0, 0,12,12, 0, 0,12,12, 0,13,13, 0, 0,13,13,13,13,13, 0,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,
    13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13, 0,12,12,12, 0,12,12,15,15,12,12,12,12,12,12, 0,15,12, 0,13,13,13, 0,13,13,13,13,13, 0, 0,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,
    13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13, 0,15,12,15,12,15,15,15,15,12,12,15,12, 0,15,12,12,12, 0,13, 0,13,13,13,13, 0, 0,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,
    13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13, 0,12,12,15,15,15,15, 4, 4,15,15,15,15,15, 0,12,12,12,12, 0,13,13,13,13, 0, 0,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,
    13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13, 0, 0, 0, 0,12,12,12,15,12,15, 4, 4,15,12,12,15,12,12, 0,12,12, 0,13,13,13,13, 0,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,
    13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13, 0,15,15,12, 0,12,12,12, 0,12,12, 0,12, 0,12,12, 0,12,12,12, 0, 0,13,13,13,13,13,13,13,13,13, 0, 0, 0,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,
    13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13, 0,15,12,12,12, 0,12, 0,12, 0,12, 0,15, 0,15, 0,12, 0,12, 0,12,12,12, 0, 0, 0,13,13,13,13, 0, 0,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,
    13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13, 0,15,15,15,12, 0,13, 0,15, 0,15, 0,15, 4,15, 4,15, 0,15, 0,15,15, 0,12,12,12,12, 0, 0,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,
    13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13, 0,15,12,12,12, 0,13,13, 0,15,15,15,15,15,15, 4,15,15,15,15,15, 0,15, 0, 0,15,12,12,12,12, 0, 0,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,
    13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13, 0,15,12,12, 0, 0,13,13,13,13, 0,15,15, 0, 0,15,15,15, 0, 0,15,15,15,15, 0,13, 0,15,15,12,12,12,12, 0,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,
    13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13, 0,15,12, 0,13,13,13,13,13,13, 0,15, 0,15,15, 0,15, 0,15,15, 0,15,15, 0,13,13,13, 0, 0,15,15,12,12,12, 0,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,
    13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13, 0,15,12, 0,13,13,13,13,13,13,13, 0,15,15,15,15,15,15,15,15,15,15,15,15, 0,13,13,13,13,13, 0, 0,15,12,12, 0,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,
    13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13, 0,15,12, 0,13,13,13,13,13,13,13,13, 0,15,15,15,15,15,15,15,15,15,15, 0,13,13,13,13,13,13,13, 0, 0,15,12, 0,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,
    13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13, 0,15, 0,13,13,13,13,13,13,13,13,13,13, 0, 0,15,15, 4, 4,15,15,15, 0,13,13,13,15,13,13,13,13,13, 0,15, 0,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,
    13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13, 0,13,13,13,13,13,13,13,13,13,13,13,13,13, 0, 0, 4, 4, 0, 0, 0,13,13,13, 0,15,13,13,15,13,13, 0,15, 0,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,
    13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13, 0,13, 0,13,13,13,13,13,13,13,13,13,13,13,13,13, 4, 4,13,13,13,13,13,13, 0,15,13,15, 0,13,13,13, 0,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,
    13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13, 0,13,13,13,13,13,13,13,13,13,13,13,13,13,13,15,15,13,13,13,13,13,13, 0,15,15, 0,13,13,13,13, 0,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,
    13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13, 0,13, 0,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13, 0,15, 0,15,15, 0,13,13, 0,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,
    13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13, 0,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13, 0,15,15, 0,13,13,13, 0,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,
    13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13, 0, 0,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,
    13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13
};

extern void k_stop(void);

void k_panic(const char *str)
{
    int i;

    k_cls();
    for (i = 0; i < 2000; ++i)
    {
        set_back_color(_fail_image[i]);
        k_putc(' ');
    }
    y -=2;

    set_back_color(black);
    set_fore_color(white);

    k_puts("KERNEL PANIC");
    k_puts(str);

    k_stop();
}

